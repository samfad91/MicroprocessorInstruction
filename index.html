<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microprocessor Instruction Execution - Three Phases</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: #e6f7ff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(15, 32, 39, 0.8);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid #2a6478;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            background: linear-gradient(90deg, #00c6ff, #0072ff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            font-size: 1.3rem;
            color: #a3d9ff;
            margin-bottom: 10px;
        }

        .instruction-details {
            background: rgba(0, 50, 80, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 800px;
            border: 1px solid #2a6478;
        }

        .phase-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
        }

        .phase {
            flex: 1;
            min-width: 300px;
            background: rgba(15, 32, 39, 0.8);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 2px solid #2a6478;
            transition: transform 0.3s ease, border-color 0.3s ease;
        }

        .phase.active {
            border-color: #00c6ff;
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 114, 255, 0.2);
        }

        .phase-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid;
        }

        .phase-1 .phase-header {
            border-color: #00c6ff;
        }

        .phase-2 .phase-header {
            border-color: #00ffaa;
        }

        .phase-3 .phase-header {
            border-color: #ffaa00;
        }

        h2 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .phase-number {
            display: inline-block;
            width: 35px;
            height: 35px;
            background: #0072ff;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: bold;
        }

        .phase-2 .phase-number {
            background: #00cc88;
        }

        .phase-3 .phase-number {
            background: #ff9900;
        }

        .phase-subtitle {
            color: #a3d9ff;
            font-size: 1.1rem;
        }

        .system-diagram {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 20px;
        }

        .microprocessor {
            flex: 1;
            min-width: 300px;
            background: rgba(20, 40, 60, 0.9);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #2a6478;
            position: relative;
            min-height: 400px;
        }

        .microprocessor-title {
            text-align: center;
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #00c6ff;
            font-weight: bold;
        }

        .component {
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
            background: rgba(0, 40, 80, 0.5);
            border: 1px solid #2a6478;
            transition: all 0.3s ease;
            position: relative;
        }

        .component.active {
            background: rgba(0, 100, 200, 0.3);
            border-color: #00c6ff;
            box-shadow: 0 0 15px rgba(0, 198, 255, 0.3);
        }

        .component-title {
            font-weight: bold;
            color: #66ccff;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .component-value {
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px;
            border-radius: 5px;
            margin-top: 5px;
            border: 1px solid #3a7a8c;
            color: #fff;
        }

        .component-value.highlight {
            background: rgba(0, 100, 200, 0.5);
            color: #a3e4ff;
            border-color: #00c6ff;
        }

        .memory {
            flex: 1;
            min-width: 300px;
            background: rgba(20, 40, 60, 0.9);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #2a6478;
            min-height: 400px;
        }

        .memory-title {
            text-align: center;
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #00ffaa;
            font-weight: bold;
        }

        .memory-cell {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            background: rgba(0, 30, 60, 0.5);
            border: 1px solid #2a6478;
            transition: all 0.3s ease;
        }

        .memory-cell.active {
            background: rgba(0, 150, 100, 0.3);
            border-color: #00ffaa;
            box-shadow: 0 0 15px rgba(0, 255, 170, 0.3);
        }

        .memory-address {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #66ffcc;
        }

        .memory-content {
            font-family: 'Courier New', monospace;
            color: #fff;
        }

        .memory-content.highlight {
            color: #a3ffd9;
            font-weight: bold;
        }

        .data-bus {
            position: relative;
            height: 20px;
            margin: 30px 0;
            background: linear-gradient(90deg, transparent, #2a6478, transparent);
            border-radius: 10px;
            overflow: hidden;
        }

        .data-bus::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 10px,
                #00c6ff 10px,
                #00c6ff 20px
            );
        }

        .data-bus::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 10px,
                #00c6ff 10px,
                #00c6ff 20px
            );
        }

        .data-packet {
            position: absolute;
            top: 0;
            left: 0;
            width: 100px;
            height: 100%;
            background: linear-gradient(90deg, rgba(0, 198, 255, 0.2), rgba(0, 114, 255, 0.4));
            border-radius: 10px;
            transition: left 2s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            border: 1px solid #00c6ff;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            background: linear-gradient(90deg, #0072ff, #00c6ff);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 114, 255, 0.4);
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-reset {
            background: linear-gradient(90deg, #ff416c, #ff4b2b);
        }

        .phase-description {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 30, 60, 0.3);
            border-radius: 10px;
            border-left: 4px solid #00c6ff;
        }

        .phase-2 .phase-description {
            border-left-color: #00ffaa;
        }

        .phase-3 .phase-description {
            border-left-color: #ffaa00;
        }

        .description-title {
            font-weight: bold;
            color: #66ccff;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .description-text {
            line-height: 1.6;
            color: #cce7ff;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #a3d9ff;
            font-size: 0.9rem;
            border-top: 1px solid #2a6478;
        }

        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }

        .pulse {
            animation: pulse 1.5s infinite;
        }

        @media (max-width: 768px) {
            .phase-container {
                flex-direction: column;
            }
            
            .system-diagram {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-microchip"></i> Microprocessor Instruction Execution</h1>
            <p class="subtitle">Three-Phase Execution of an Arithmetic Instruction with Single Operand (Direct Addressing Mode)</p>
            
            <div class="instruction-details">
                <p><i class="fas fa-info-circle"></i> <strong>Instruction Example:</strong> ADD [2050] - Add the value at memory address 2050 to the accumulator</p>
                <p><i class="fas fa-map-marker-alt"></i> <strong>Addressing Mode:</strong> Direct (operand address is part of the instruction)</p>
            </div>
        </header>

        <div class="phase-container">
            <div class="phase phase-1 active" id="phase1">
                <div class="phase-header">
                    <h2><span class="phase-number">1</span> <i class="fas fa-download"></i> Instruction Fetch</h2>
                    <p class="phase-subtitle">Fetching the instruction from memory</p>
                </div>
                
                <div class="phase-description">
                    <div class="description-title"><i class="fas fa-list-alt"></i> What happens:</div>
                    <div class="description-text">
                        <p>1. Program Counter (PC) holds address of next instruction ($2000)</p>
                        <p>2. Address is sent to memory via address bus</p>
                        <p>3. Memory returns instruction code (e.g., ADD instruction)</p>
                        <p>4. Instruction is stored in Instruction Register (IR)</p>
                        <p>5. PC is incremented to point to next memory location</p>
                    </div>
                </div>
            </div>
            
            <div class="phase phase-2" id="phase2">
                <div class="phase-header">
                    <h2><span class="phase-number">2</span> <i class="fas fa-cogs"></i> Instruction Decode & Operand Fetch</h2>
                    <p class="phase-subtitle">Decoding instruction and fetching operand from memory</p>
                </div>
                
                <div class="phase-description">
                    <div class="description-title"><i class="fas fa-list-alt"></i> What happens:</div>
                    <div class="description-text">
                        <p>1. Instruction decoder decodes the ADD instruction</p>
                        <p>2. Identifies direct addressing mode (operand address follows instruction)</p>
                        <p>3. Fetches operand address from next memory location ($2001)</p>
                        <p>4. Sends operand address to memory</p>
                        <p>5. Memory returns actual operand value</p>
                        <p>6. Operand is stored in temporary register</p>
                    </div>
                </div>
            </div>
            
            <div class="phase phase-3" id="phase3">
                <div class="phase-header">
                    <h2><span class="phase-number">3</span> <i class="fas fa-play-circle"></i> Instruction Execution</h2>
                    <p class="phase-subtitle">Executing the instruction and moving to next instruction</p>
                </div>
                
                <div class="phase-description">
                    <div class="description-title"><i class="fas fa-list-alt"></i> What happens:</div>
                    <div class="description-text">
                        <p>1. ALU receives ADD operation code</p>
                        <p>2. Operand value is sent to ALU</p>
                        <p>3. Accumulator value is sent to ALU</p>
                        <p>4. ALU performs addition operation</p>
                        <p>5. Result is stored back in accumulator</p>
                        <p>6. Status flags are updated (Zero, Carry, etc.)</p>
                        <p>7. PC now points to next instruction ($2002)</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="system-diagram">
            <div class="microprocessor">
                <div class="microprocessor-title"><i class="fas fa-microchip"></i> MICROPROCESSOR</div>
                
                <div class="component" id="pc-component">
                    <div class="component-title"><i class="fas fa-map-pin"></i> Program Counter (PC)</div>
                    <div class="component-value" id="pc-value">$2000</div>
                </div>
                
                <div class="component" id="ir-component">
                    <div class="component-title"><i class="fas fa-file-code"></i> Instruction Register (IR)</div>
                    <div class="component-value" id="ir-value">---</div>
                </div>
                
                <div class="component" id="decoder-component">
                    <div class="component-title"><i class="fas fa-code"></i> Instruction Decoder</div>
                    <div class="component-value" id="decoder-value">---</div>
                </div>
                
                <div class="component" id="alu-component">
                    <div class="component-title"><i class="fas fa-calculator"></i> Arithmetic Logic Unit (ALU)</div>
                    <div class="component-value" id="alu-value">---</div>
                </div>
                
                <div class="component" id="acc-component">
                    <div class="component-title"><i class="fas fa-database"></i> Accumulator (ACC)</div>
                    <div class="component-value" id="acc-value">$0025</div>
                </div>
                
                <div class="component" id="temp-component">
                    <div class="component-title"><i class="fas fa-temp"></i> Temporary Register</div>
                    <div class="component-value" id="temp-value">---</div>
                </div>
            </div>
            
            <div class="data-bus" id="data-bus">
                <div class="data-packet" id="data-packet">DATA</div>
            </div>
            
            <div class="memory">
                <div class="memory-title"><i class="fas fa-memory"></i> MEMORY</div>
                
                <div class="memory-cell" id="mem-2000">
                    <div class="memory-address">$2000</div>
                    <div class="memory-content" id="content-2000">ADD [2050]</div>
                </div>
                
                <div class="memory-cell" id="mem-2001">
                    <div class="memory-address">$2001</div>
                    <div class="memory-content" id="content-2001">$2050</div>
                </div>
                
                <div class="memory-cell" id="mem-2002">
                    <div class="memory-address">$2002</div>
                    <div class="memory-content" id="content-2002">SUB [2052]</div>
                </div>
                
                <div class="memory-cell" id="mem-2050">
                    <div class="memory-address">$2050</div>
                    <div class="memory-content" id="content-2050">$0012</div>
                </div>
                
                <div class="memory-cell" id="mem-2052">
                    <div class="memory-address">$2052</div>
                    <div class="memory-content" id="content-2052">$0005</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn" id="phase1-btn">
                <i class="fas fa-download"></i> Show Phase 1: Instruction Fetch
            </button>
            <button class="btn" id="phase2-btn">
                <i class="fas fa-cogs"></i> Show Phase 2: Decode & Operand Fetch
            </button>
            <button class="btn" id="phase3-btn">
                <i class="fas fa-play-circle"></i> Show Phase 3: Execution
            </button>
            <button class="btn" id="animate-btn">
                <i class="fas fa-play"></i> Animate All Phases
            </button>
            <button class="btn btn-reset" id="reset-btn">
                <i class="fas fa-redo"></i> Reset
            </button>
        </div>

        <div class="footer">
            <p><i class="fas fa-code"></i> Interactive visualization of microprocessor instruction execution cycle | Three-phase execution model</p>
            <p>Phase 1: Instruction Fetch → Phase 2: Decode & Operand Fetch → Phase 3: Execution</p>
        </div>
    </div>

    <script>
        // Current phase state
        let currentPhase = 1;
        let animationInterval = null;
        
        // Memory and register values
        const memoryValues = {
            '2000': 'ADD [2050]',
            '2001': '$2050',
            '2002': 'SUB [2052]',
            '2050': '$0012',
            '2052': '$0005'
        };
        
        // Initialize the visualization
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            showPhase(1);
        });
        
        // Setup event listeners for buttons
        function setupEventListeners() {
            document.getElementById('phase1-btn').addEventListener('click', () => showPhase(1));
            document.getElementById('phase2-btn').addEventListener('click', () => showPhase(2));
            document.getElementById('phase3-btn').addEventListener('click', () => showPhase(3));
            document.getElementById('animate-btn').addEventListener('click', animateAllPhases);
            document.getElementById('reset-btn').addEventListener('click', resetVisualization);
        }
        
        // Show a specific phase
        function showPhase(phaseNumber) {
            currentPhase = phaseNumber;
            
            // Update phase highlighting
            document.querySelectorAll('.phase').forEach(phase => {
                phase.classList.remove('active');
            });
            document.getElementById(`phase${phaseNumber}`).classList.add('active');
            
            // Reset all components
            resetAllHighlights();
            
            // Show the appropriate phase
            switch(phaseNumber) {
                case 1:
                    showPhase1();
                    break;
                case 2:
                    showPhase2();
                    break;
                case 3:
                    showPhase3();
                    break;
            }
        }
        
        // Show phase 1: Instruction Fetch
        function showPhase1() {
            // Highlight PC
            document.getElementById('pc-component').classList.add('active');
            document.getElementById('pc-value').classList.add('highlight');
            
            // Highlight memory cell for instruction
            document.getElementById('mem-2000').classList.add('active');
            document.getElementById('content-2000').classList.add('highlight');
            
            // Show instruction in IR
            document.getElementById('ir-value').textContent = 'ADD [2050]';
            document.getElementById('ir-value').classList.add('highlight');
            document.getElementById('ir-component').classList.add('active');
            
            // Animate data transfer
            animateDataTransfer('PC → Memory', 'Fetching instruction...');
            
            // Update PC after fetch
            setTimeout(() => {
                document.getElementById('pc-value').textContent = '$2001';
            }, 1000);
        }
        
        // Show phase 2: Instruction Decode & Operand Fetch
        function showPhase2() {
            // IR already has instruction from phase 1
            document.getElementById('ir-component').classList.add('active');
            document.getElementById('ir-value').textContent = 'ADD [2050]';
            document.getElementById('ir-value').classList.add('highlight');
            
            // Highlight decoder
            document.getElementById('decoder-component').classList.add('active');
            document.getElementById('decoder-value').textContent = 'ADD (Direct)';
            document.getElementById('decoder-value').classList.add('highlight');
            
            // Highlight operand address in memory
            document.getElementById('mem-2001').classList.add('active');
            document.getElementById('content-2001').classList.add('highlight');
            
            // Fetch operand from memory address 2050
            setTimeout(() => {
                document.getElementById('mem-2050').classList.add('active');
                document.getElementById('content-2050').classList.add('highlight');
                
                // Store operand in temporary register
                document.getElementById('temp-component').classList.add('active');
                document.getElementById('temp-value').textContent = '$0012';
                document.getElementById('temp-value').classList.add('highlight');
                
                // Animate data transfer
                animateDataTransfer('Memory → Temp', 'Fetching operand...');
                
                // Update PC after fetching operand address
                document.getElementById('pc-value').textContent = '$2002';
                document.getElementById('pc-component').classList.add('active');
                document.getElementById('pc-value').classList.add('highlight');
            }, 1000);
        }
        
        // Show phase 3: Instruction Execution
        function showPhase3() {
            // Show ALU operation
            document.getElementById('alu-component').classList.add('active');
            document.getElementById('alu-value').textContent = 'ADD';
            document.getElementById('alu-value').classList.add('highlight');
            
            // Show accumulator
            document.getElementById('acc-component').classList.add('active');
            document.getElementById('acc-value').classList.add('highlight');
            
            // Show temporary register with operand
            document.getElementById('temp-component').classList.add('active');
            document.getElementById('temp-value').textContent = '$0012';
            document.getElementById('temp-value').classList.add('highlight');
            
            // Animate data transfer to ALU
            animateDataTransfer('ACC + Temp → ALU', 'Performing addition...');
            
            // Show result in accumulator
            setTimeout(() => {
                document.getElementById('acc-value').textContent = '$0037';
                document.getElementById('acc-value').classList.add('pulse');
                
                // PC now points to next instruction
                document.getElementById('pc-component').classList.add('active');
                document.getElementById('pc-value').textContent = '$2002';
                document.getElementById('pc-value').classList.add('highlight');
                
                // Highlight next instruction in memory
                document.getElementById('mem-2002').classList.add('active');
                document.getElementById('content-2002').classList.add('highlight');
            }, 1500);
        }
        
        // Animate data transfer on the bus
        function animateDataTransfer(label, title) {
            const dataPacket = document.getElementById('data-packet');
            const dataBus = document.getElementById('data-bus');
            
            // Set label and title
            dataPacket.textContent = label;
            dataPacket.title = title;
            
            // Reset position
            dataPacket.style.left = '0px';
            dataPacket.style.opacity = '1';
            dataPacket.classList.add('pulse');
            
            // Animate across the bus
            setTimeout(() => {
                const busWidth = dataBus.offsetWidth;
                dataPacket.style.left = (busWidth - 100) + 'px';
                
                // Hide after animation
                setTimeout(() => {
                    dataPacket.style.opacity = '0';
                    dataPacket.classList.remove('pulse');
                }, 2000);
            }, 100);
        }
        
        // Animate through all phases
        function animateAllPhases() {
            if (animationInterval) {
                clearInterval(animationInterval);
                animationInterval = null;
                document.getElementById('animate-btn').innerHTML = '<i class="fas fa-play"></i> Animate All Phases';
                return;
            }
            
            document.getElementById('animate-btn').innerHTML = '<i class="fas fa-pause"></i> Pause Animation';
            resetVisualization();
            
            let phase = 1;
            showPhase(phase);
            
            animationInterval = setInterval(() => {
                phase++;
                if (phase > 3) {
                    clearInterval(animationInterval);
                    animationInterval = null;
                    document.getElementById('animate-btn').innerHTML = '<i class="fas fa-play"></i> Animate All Phases';
                    return;
                }
                showPhase(phase);
            }, 4000);
        }
        
        // Reset all highlights and values
        function resetAllHighlights() {
            // Reset components
            document.querySelectorAll('.component').forEach(comp => {
                comp.classList.remove('active');
            });
            
            document.querySelectorAll('.component-value').forEach(value => {
                value.classList.remove('highlight', 'pulse');
            });
            
            // Reset memory cells
            document.querySelectorAll('.memory-cell').forEach(cell => {
                cell.classList.remove('active');
            });
            
            document.querySelectorAll('.memory-content').forEach(content => {
                content.classList.remove('highlight');
            });
            
            // Reset data packet
            document.getElementById('data-packet').style.opacity = '0';
            
            // Reset register values
            document.getElementById('pc-value').textContent = '$2000';
            document.getElementById('ir-value').textContent = '---';
            document.getElementById('decoder-value').textContent = '---';
            document.getElementById('alu-value').textContent = '---';
            document.getElementById('acc-value').textContent = '$0025';
            document.getElementById('temp-value').textContent = '---';
        }
        
        // Reset the entire visualization
        function resetVisualization() {
            if (animationInterval) {
                clearInterval(animationInterval);
                animationInterval = null;
                document.getElementById('animate-btn').innerHTML = '<i class="fas fa-play"></i> Animate All Phases';
            }
            
            resetAllHighlights();
            currentPhase = 1;
            showPhase(1);
        }
    </script>
</body>
</html>
